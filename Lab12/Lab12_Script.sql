--Lab12_Script.sql
--Name: Marissa GonÃ§alves
--Date: November 29, 2018


CONNECT scott/tiger;
SET LINESIZE 200;
SET PAGESIZE 40;
SET ECHO ON;



SPOOL "D:\Semester III\Database I\Labs\Lab12\Lab12_Spool.txt";
START "D:\Marissa\indo_n2.sql";





--Question 1:

SELECT EMPLOYEEID, LNAME, FNAME, DEPTID,
(SELECT AVG(SALARY)
FROM EMPLOYEE E2
WHERE E2.DEPTID = E1.DEPTID)
AS "Dept Salary Avg"
FROM EMPLOYEE E1;






--Question 2:

SELECT EMPLOYEEID, LNAME, FNAME, SALARY, DEPTID
FROM EMPLOYEE E
WHERE SALARY > (SELECT AVG(SALARY)
                FROM EMPLOYEE
				WHERE DEPTID = E.DEPTID);



DISCONNECT;










CONNECT hr/hr;
SET LINESIZE 200;
SET PAGESIZE 40;
SET ECHO ON;




--Question 3:

SELECT FIRST_NAME, LAST_NAME,
(SELECT DEPARTMENT_NAME
FROM DEPARTMENTS D
WHERE D.DEPARTMENT_ID = E.DEPARTMENT_ID)
AS "Department Name"
FROM EMPLOYEES E;








--Question 4:

SELECT DEPARTMENT_ID, DEPARTMENT_NAME,
(SELECT FIRST_NAME ||' '|| LAST_NAME
FROM EMPLOYEES E
WHERE E.EMPLOYEE_ID = D.MANAGER_ID)
AS "Manager"
FROM DEPARTMENTS D;








SPOOL OFF;